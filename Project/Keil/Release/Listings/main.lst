C51 COMPILER V9.60.7.0   MAIN                                                              11/18/2024 17:39:07 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Release\Objects\main.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE ..\..\User\main.c LARGE OPTIMIZE(8,SIZE) BROWSE INTVECTOR(0X000C) INCDIR
                    -(..\..\Libraries\Include;..\..\User;..\..\User\lib;..\..\Hardware) INTERVAL(3) DEBUG OBJECTEXTEND PRINT(.\Release\Listin
                    -gs\main.lst) OBJECT(.\Release\Objects\main.obj)

line level    source

   1          /**
   2           ******************************************************************************
   3           * @file    main.c
   4           * @author  HUGE-IC Application Team
   5           * @version V1.0.0
   6           * @date    05-11-2022
   7           * @brief   Main program body
   8           ******************************************************************************
   9           * @attention
  10           *
  11           * <h2><center>&copy; COPYRIGHT 2021 HUGE-IC</center></h2>
  12           *
  13           * 版权说明后续补上
  14           *
  15           ******************************************************************************
  16           */
  17          
  18          /* Includes ------------------------------------------------------------------*/
  19          #include "include.h"
  20          
  21          /** @addtogroup Template_Project
  22           * @{
  23           */
  24          
  25          /* Private typedef -----------------------------------------------------------*/
  26          /* Private define ------------------------------------------------------------*/
  27          /* Private macro -------------------------------------------------------------*/
  28          /* Private variables ---------------------------------------------------------*/
  29          /* Private function prototypes -----------------------------------------------*/
  30          /* Private functions ---------------------------------------------------------*/
  31          
  32          /**
  33           * @brief  Main program.
  34           * @param  None
  35           * @retval None
  36           */
  37          // extern u32 test_val; // 测试用
  38          
  39          // enum
  40          // {
  41          //     CUR_SCAN_ENGINE_SPEED, // 当前要扫描引擎速度
  42          //     CUR_SCAN_SPEED, // 当前要扫描时速
  43          // }
  44          
  45          void main(void)
  46          {
  47   1          // 看门狗默认打开, 复位时间2s
  48   1          system_init();
  49   1      
  50   1          WDT_KEY = WDT_KEY_VAL(0xDD); //  关闭看门狗
  51   1      
  52   1          // 关闭HCK和HDA的调试功能
  53   1          WDT_KEY = 0x55;  // 解除写保护
C51 COMPILER V9.60.7.0   MAIN                                                              11/18/2024 17:39:07 PAGE 2   

  54   1          IO_MAP &= ~0x01; // 清除这个寄存器的值，实现关闭HCK和HDA引脚的调试功能（解除
             -射）
  55   1          WDT_KEY = 0xBB;
  56   1      
  57   1          /* 用户代码初始化接口 */
  58   1          user_init();
  59   1      
  60   1          // 测试用，一上电打印flash中存放的信息
  61   1          printf("year %d month %d day %d \n", (u16)fun_info.year, (u16)fun_info.month, (u16)fun_info.day);
  62   1      
  63   1          /* 按键初始化 */
  64   1          // tk_param_init();
  65   1      
  66   1          /* 系统主循环 */
  67   1          while (1)
  68   1          {
  69   2              /* 按键扫描函数 */
  70   2              // __tk_scan(); // 使用了库里面的接口（闭源库）
  71   2      
  72   2              /* 用户循环扫描函数接口 */
  73   2              // user_handle();
  74   2      
  75   2              // 扫描状态是否变化，如果变化则更新标志位，更新状态的信息到结构体
             -
  76   2              // pin_level_scan();
  77   2              // speed_scan();        // 扫描当前时速
  78   2              // engine_speed_scan(); // 扫描当前发动机转速
  79   2              // adc_scan(); // adc扫描，并转换成百分比的形式发送
  80   2              // mileage_scan(); // 里程扫描（大计里程扫描+小计里程扫描）
  81   2      
  82   2              // 1. 测试 从串口接收指令，是否能够正确识别
  83   2              {
  84   3                  uart0_scan_handle();  // 检查串口接收缓冲区的数据是否符合协议,如果有正
             -的指令，会存到另一个缓冲区中
  85   3                  instruction_scan();   // 扫描是否有合法的指令
  86   3                  instruction_handle(); // 扫描是否有对应的获取/状态更新操作
  87   3              }
  88   2      
  89   2              // 2. 测试 时速和发动机的转速的扫描，并且不会阻塞主循环
  90   2              {
  91   3                  engine_speed_scan(); // 检测发动机转速
  92   3                  speed_scan(); // 检测时速
  93   3                  mileage_scan(); // 检测大计里程和小计里程
  94   3              }
  95   2          }
  96   1      }
  97          
  98          /**
  99           * @}
 100           */
 101          
 102          /*************************** (C) COPYRIGHT 2022 HUGE-IC ***** END OF FILE *****/


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     92    ----
   CONSTANT SIZE    =     26    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
C51 COMPILER V9.60.7.0   MAIN                                                              11/18/2024 17:39:07 PAGE 3   

END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
